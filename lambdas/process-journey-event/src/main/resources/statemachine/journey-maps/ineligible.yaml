# Entry points

INELIGIBLE:
  events:
    next:
      targetState: ANOTHER_WAY_PAGE
      checkFeatureFlag:
        ticfCriBeta:
          targetState: CRI_TICF_BEFORE_ANOTHER_WAY

INELIGIBLE_NO_TICF:
  events:
    next:
      targetState: ANOTHER_WAY_PAGE

INELIGIBLE_SKIP_MESSAGE:
  events:
    next:
      targetState: RETURN_TO_RP
      checkFeatureFlag:
        ticfCriBeta:
          targetState: CRI_TICF_BEFORE_RETURN_TO_RP

# Journey states

CRI_TICF_BEFORE_ANOTHER_WAY:
  response:
    type: process
    lambda: call-ticf-cri
  events:
    next:
      targetState: ANOTHER_WAY_PAGE
    enhanced-verification:
      targetState: ANOTHER_WAY_PAGE
    alternate-doc-invalid-dl:
      targetState: ANOTHER_WAY_PAGE
    fail-with-ci:
      targetJourney: FAILED
      targetState: FAILED_NO_TICF
    error:
      targetJourney: TECHNICAL_ERROR
      targetState: ERROR_NO_TICF

CRI_TICF_BEFORE_RETURN_TO_RP:
  response:
    type: process
    lambda: call-ticf-cri
  events:
    next:
      targetState: RETURN_TO_RP
    enhanced-verification:
      targetJourney: FAILED
      targetState: FAILED_NO_TICF
    alternate-doc-invalid-dl:
      targetJourney: FAILED
      targetState: FAILED_NO_TICF
    fail-with-ci:
      targetJourney: FAILED
      targetState: FAILED_NO_TICF
    error:
      targetJourney: TECHNICAL_ERROR
      targetState: ERROR_NO_TICF

ANOTHER_WAY_PAGE:
  response:
    type: page
    pageId: pyi-another-way
  events:
    next:
      targetState: RETURN_TO_RP

RETURN_TO_RP:
  response:
    type: process
    lambda: build-client-oauth-response
