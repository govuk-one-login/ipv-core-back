#parent states
ATTEMPT_RECOVERY_STATE:
  name: ATTEMPT_RECOVERY_STATE
  parent: null
  events:
    attempt-recovery:
      type: basic
      name: attempt-recover
      targetState: EVALUATE_GPG45_SCORES
      response:
        type: journey
        journeyStepId: /journey/evaluate-gpg45-scores

CRI_STATE:
  name: CRI_STATE
  parent: ATTEMPT_RECOVERY_STATE
  events:
    error:
      type: basic
      name: error
      targetState: CRI_ERROR
      response:
        type: error
        pageId: pyi-technical
        statusCode: 500
    access-denied:
      type: basic
      name: access-denied
      targetState: PYI_NO_MATCH
      response:
        type: page
        pageId: pyi-no-match
    temporarily-unavailable:
      type: basic
      name: temporarily-unavailable
      targetState: PYI_NO_MATCH
      response:
        type: page
        pageId: pyi-no-match
END_JOURNEY:
  name: END_JOURNEY
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: END
      response:
        type: journey
        journeyStepId: /journey/build-client-oauth-response
MITIGATION_JOURNEY:
  name: MITIGATION_JOURNEY
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: EVALUATE_GPG45_SCORES
      response:
        type: journey
        journeyStepId: /journey/evaluate-gpg45-scores

#child states
INITIAL_IPV_JOURNEY:
  name: INIT
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: IPV_IDENTITY_START_PAGE
      response:
        type: page
        pageId: page-ipv-identity-start
IPV_IDENTITY_START_PAGE:
  name: IPV_IDENTITY_START_PAGE
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CHECK_EXISTING_IDENTITY
      response:
        type: journey
        journeyStepId: /journey/check-existing-identity
CHECK_EXISTING_IDENTITY:
  name: CHECK_EXISTING_IDENTITY
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: cri
      name: next
      targetState: CRI_DCMAW_J1
      criId: dcmaw
      disabled:
        type: basic
        name: access-denied-multi-doc
        targetState: MULTIPLE_DOC_CHECK_PAGE_J2
        response:
          type: page
          pageId: page-multiple-doc-check
    reuse:
      type: basic
      name: reuse
      targetState: IPV_IDENTITY_REUSE_PAGE
      response:
        type: page
        pageId: page-ipv-reuse

# DCMAW BRANCH
CRI_DCMAW_J1:
  name: CRI_DCMAW_J1
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_ADDRESS_J1
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/address
    access-denied-multi-doc:
      type: basic
      name: access-denied-multi-doc
      targetState: MULTIPLE_DOC_CHECK_PAGE_J2
      response:
        type: page
        pageId: page-multiple-doc-check

CRI_ADDRESS_J1:
  name: CRI_ADDRESS_J1
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_FRAUD_J1
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/fraud

CRI_FRAUD_J1:
  name: CRI_FRAUD_J1
  parent: CRI_STATE
  events:
    end:
      type: basic
      name: end
      targetState: IPV_SUCCESS_PAGE
      response:
        type: page
        pageId: page-ipv-success

# PASSPORT BRANCH
MULTIPLE_DOC_CHECK_PAGE_J2:
  name: MULTIPLE_DOC_CHECK_PAGE_J2
  events:
    ukPassport:
      type: basic
      name: ukPassport
      targetState: CRI_UK_PASSPORT_J2
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/ukPassport
    drivingLicence:
      type: basic
      name: drivingLicence
      targetState: CRI_DRIVING_LICENCE_J3
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/drivingLicence
    end:
      type: featureSet
      name: end
      featureSets:
        default:
          type: basic
          name: default
          targetState: END
          response:
            type: journey
            journeyStepId: /journey/build-client-oauth-response
        f2fBeta:
          type: basic
          name: f2fBeta
          targetState: CRI_CLAIMED_IDENTITY_J4
          response:
            type: journey
            journeyStepId: /journey/cri/build-oauth-request/claimedIdentity


CRI_UK_PASSPORT_J2:
  name: CRI_UK_PASSPORT_J2
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_ADDRESS_J2
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/address

CRI_ADDRESS_J2:
  name: CRI_ADDRESS_J2
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_FRAUD_J2
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/fraud

CRI_FRAUD_J2:
  name: CRI_FRAUD_J2
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: PRE_KBV_TRANSITION_PAGE_J2
      response:
        type: page
        pageId: page-pre-kbv-transition

PRE_KBV_TRANSITION_PAGE_J2:
  name: PRE_KBV_TRANSITION_PAGEJ2
  events:
    next:
      type: basic
      name: next
      targetState: CRI_KBV_J2
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/kbv

CRI_KBV_J2:
  name: CRI_KBV_J2
  parent: CRI_STATE
  events:
    end:
      type: basic
      name: end
      targetState: IPV_SUCCESS_PAGE
      response:
        type: page
        pageId: page-ipv-success

# DRIVING LICENSE BRANCH
CRI_DRIVING_LICENCE_J3:
  name: CRI_DRIVING_LICENCE_J3
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_ADDRESS_J3
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/address

CRI_ADDRESS_J3:
  name: CRI_ADDRESS_J3
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_FRAUD_J3
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/fraud

CRI_FRAUD_J3:
  name: CRI_FRAUD_J3
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: PRE_KBV_TRANSITION_PAGE_J3
      response:
        type: page
        pageId: page-pre-kbv-transition

PRE_KBV_TRANSITION_PAGE_J3:
  name: PRE_KBV_TRANSITION_PAGE_J3
  events:
    next:
      type: basic
      name: next
      targetState: CRI_KBV_J3
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/kbv

CRI_KBV_J3:
  name: CRI_KBV_J3
  parent: CRI_STATE
  events:
    end:
      type: basic
      name: end
      targetState: IPV_SUCCESS_PAGE
      response:
        type: page
        pageId: page-ipv-success

# F2F branch
CRI_CLAIMED_IDENTITY_J4:
  name: CRI_CLAIMED_IDENTITY_J4
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_ADDRESS_J4
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/address

CRI_ADDRESS_J4:
  name: CRI_ADDRESS_J4
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_FRAUD_J4
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/fraud

CRI_FRAUD_J4:
  name: CRI_FRAUD_J4
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_F2F_J4
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/f2f

CRI_F2F_J4:
  name: CRI_F2F_J4
  parent: CRI_STATE
  events:
    pending:
      type: basic
      name: pending
      targetState: F2F_HANDOFF_PAGE_J4
      response:
        type: page
        pageId: page-face-to-face-handoff

F2F_HANDOFF_PAGE_J4:
  name: F2F_HANDOFF_PAGE
  parent: ATTEMPT_RECOVERY_STATE



# Original stuff below here. I think.

IPV_IDENTITY_REUSE_PAGE:
  name: IPV_IDENTITY_REUSE_PAGE
  parent: END_JOURNEY
EVALUATE_GPG45_SCORES:
  name: EVALUATE_GPG45_SCORES
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: SELECT_CRI
      response:
        type: journey
        journeyStepId: /journey/select-cri
    end:
      type: basic
      name: end
      targetState: IPV_SUCCESS_PAGE
      response:
        type: page
        pageId: page-ipv-success
    pyi-no-match:
      type: basic
      name: pyi-no-match
      targetState: PYI_NO_MATCH
      response:
        type: page
        pageId: pyi-no-match
    pyi-kbv-fail:
      type: basic
      name: pyi-kbv-fail
      targetState: PYI_KBV_FAIL
      response:
        type: page
        pageId: pyi-kbv-fail
SELECT_CRI:
  name: SELECT_CRI
  parent: ATTEMPT_RECOVERY_STATE
  events:
    ukPassport:
      type: basic
      name: ukPassport
      targetState: PASSPORT_DOC_CHECK_PAGE
      response:
        type: page
        pageId: page-passport-doc-check
    drivingLicence:
      type: basic
      name: drivingLicence
      targetState: DRIVING_LICENCE_DOC_CHECK_PAGE
      response:
        type: page
        pageId: page-driving-licence-doc-check
    multipleDocCheckPage:
      type: basic
      name: multipleDocCheck
      targetState: MULTIPLE_DOC_CHECK_PAGE
      response:
        type: page
        pageId: page-multiple-doc-check
    multipleDocCheckWithF2FPage:
      type: basic
      name: multipleDocCheckWithF2F
      targetState: MULTIPLE_DOC_CHECK_PAGE_F2F
      response:
        type: page
        pageId: page-multiple-doc-check
    address:
      type: basic
      name: address
      targetState: CRI_ADDRESS
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/address
    fraud:
      type: basic
      name: fraud
      targetState: CRI_FRAUD
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/fraud
    claimedIdentity:
      type: basic
      name: claimedIdentity
      targetState: CRI_CLAIMED_IDENTITY
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/claimedIdentity
    f2f:
      type: basic
      name: f2f
      targetState: CRI_F2F
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/f2f
    pending:
      type: basic
      name: pending
      targetState: F2F_HANDOFF_PAGE
      response:
        type: page
        pageId: page-face-to-face-handoff
    kbv:
      type: basic
      name: kbv
      targetState: PRE_KBV_TRANSITION_PAGE
      response:
        type: page
        pageId: page-pre-kbv-transition
    dcmaw:
      type: basic
      name: dcmaw
      targetState: CRI_DCMAW
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/dcmaw
    dcmaw-success:
      type: basic
      name: dcmaw-success
      targetState: POST_DCMAW_SUCCESS_PAGE
      response:
        type: page
        pageId: page-dcmaw-success
    end-mj01:
      type: basic
      name: end-mj01
      targetState: END_MJ01
      response:
        type: journey
        journeyStepId: /journey/end-mitigation-journey/MJ01
    end-mj02:
      type: basic
      name: end-mj02
      targetState: END_MJ02
      response:
        type: journey
        journeyStepId: /journey/end-mitigation-journey/MJ02
    fail:
      type: basic
      name: fail
      targetState: SELECT_CRI_ERROR
      response:
        type: error
        pageId: pyi-technical
        statusCode: 500
    pyi-no-match:
      type: basic
      name: pyi-no-match
      targetState: PYI_NO_MATCH
      response:
        type: page
        pageId: pyi-no-match
    pyi-kbv-fail:
      type: basic
      name: pyi-kbv-fail
      targetState: PYI_KBV_FAIL
      response:
        type: page
        pageId: pyi-kbv-fail
    pyi-kbv-thin-file:
      type: basic
      name: pyi-kbv-thin-file
      targetState: PYI_KBV_THIN_FILE
      response:
        type: page
        pageId: pyi-kbv-thin-file
CRI_UK_PASSPORT:
  name: CRI_UK_PASSPORT
  parent: CRI_STATE
  events:
    access-denied-multi-doc:
      type: basic
      name: access-denied-multi-doc
      targetState: MULTIPLE_DOC_CHECK_PAGE
      response:
        type: page
        pageId: page-multiple-doc-check
CRI_DRIVING_LICENCE:
  name: CRI_DRIVING_LICENCE
  parent: CRI_STATE
  events:
    access-denied-multi-doc:
      type: basic
      name: access-denied-multi-doc
      targetState: MULTIPLE_DOC_CHECK_PAGE
      response:
        type: page
        pageId: page-multiple-doc-check
CRI_ADDRESS:
  name: CRI_ADDRESS
  parent: CRI_STATE
CRI_FRAUD:
  name: CRI_FRAUD
  parent: CRI_STATE
CRI_CLAIMED_IDENTITY:
  name: CRI_CLAIMED_IDENTITY
  parent: CRI_STATE
CRI_F2F:
  name: CRI_F2F
  parent: CRI_STATE
  events:
    pending:
      type: basic
      name: pending
      targetState: F2F_HANDOFF_PAGE
      response:
        type: page
        pageId: page-face-to-face-handoff
F2F_HANDOFF_PAGE:
  name: F2F_HANDOFF_PAGE
  parent: ATTEMPT_RECOVERY_STATE
CRI_KBV:
  name: CRI_KBV
  parent: CRI_STATE
PASSPORT_DOC_CHECK_PAGE:
  name: PASSPORT_DOC_CHECK_PAGE
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_UK_PASSPORT
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/ukPassport
    end:
      type: basic
      name: end
      targetState: END
      response:
        type: journey
        journeyStepId: /journey/build-client-oauth-response
DRIVING_LICENCE_DOC_CHECK_PAGE:
  name: DRIVING_LICENCE_DOC_CHECK_PAGE
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_DRIVING_LICENCE
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/drivingLicence
    end:
      type: basic
      name: end
      targetState: END
      response:
        type: journey
        journeyStepId: /journey/build-client-oauth-response
MULTIPLE_DOC_CHECK_PAGE:
  name: MULTIPLE_DOC_CHECK_PAGE
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_UK_PASSPORT
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/ukPassport
    ukPassport:
      type: basic
      name: ukPassport
      targetState: CRI_UK_PASSPORT
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/ukPassport
    drivingLicence:
      type: basic
      name: drivingLicence
      targetState: CRI_DRIVING_LICENCE
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/drivingLicence
    end:
      type: basic
      name: end
      targetState: END
      response:
        type: journey
        journeyStepId: /journey/build-client-oauth-response
MULTIPLE_DOC_CHECK_PAGE_F2F:
  name: MULTIPLE_DOC_CHECK_PAGE
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_UK_PASSPORT
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/ukPassport
    ukPassport:
      type: basic
      name: ukPassport
      targetState: CRI_UK_PASSPORT
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/ukPassport
    drivingLicence:
      type: basic
      name: drivingLicence
      targetState: CRI_DRIVING_LICENCE
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/drivingLicence
    end:
      type: basic
      name: end
      targetState: CRI_CLAIMED_IDENTITY
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/claimedIdentity
PRE_KBV_TRANSITION_PAGE:
  name: PRE_KBV_TRANSITION_PAGE
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_KBV
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/kbv
POST_DCMAW_SUCCESS_PAGE:
  name: POST_DCMAW_SUCCESS_PAGE
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: CRI_ADDRESS
      response:
        type: journey
        journeyStepId: /journey/cri/build-oauth-request/address
CRI_DCMAW:
  name: CRI_DCMAW
  parent: CRI_STATE
  events:
    access-denied-multi-doc:
      type: basic
      name: access-denied-multi-doc
      targetState: MULTIPLE_DOC_CHECK_PAGE
      response:
        type: page
        pageId: page-multiple-doc-check
    access-denied:
      type: basic
      name: access-denied
      targetState: EVALUATE_GPG45_SCORES
      response:
        type: journey
        journeyStepId: /journey/evaluate-gpg45-scores
    temporarily-unavailable:
      type: basic
      name: temporarily-unavailable
      targetState: EVALUATE_GPG45_SCORES
      response:
        type: journey
        journeyStepId: /journey/evaluate-gpg45-scores
    error:
      type: basic
      name: error
      targetState: CRI_ERROR
      response:
        type: error
        pageId: pyi-technical
        statusCode: 500
END_MJ01:
  name: END_MJ01
  parent: MITIGATION_JOURNEY
END_MJ02:
  name: END_MJ02
  parent: MITIGATION_JOURNEY
IPV_SUCCESS_PAGE:
  name: IPV_SUCCESS_PAGE
  parent: END_JOURNEY
PYI_NO_MATCH:
  name: PYI_NO_MATCH
  parent: END_JOURNEY
PYI_KBV_FAIL:
  name: PYI_KBV_FAIL
  parent: END_JOURNEY
PYI_KBV_THIN_FILE:
  name: PYI_KBV_THIN_FILE
  parent: END_JOURNEY
CRI_ERROR:
  name: CRI_ERROR
  parent: END_JOURNEY
SELECT_CRI_ERROR:
  name: SELECT_CRI_ERROR
  parent: END_JOURNEY
CORE_SESSION_TIMEOUT:
  name: CORE_SESSION_TIMEOUT
  parent: END_JOURNEY

#debug page state
DEBUG_PAGE:
  name: DEBUG_PAGE
  parent: CRI_STATE
  events:
    next:
      type: basic
      name: next
      targetState: DEBUG_EVALUATE_GPG45_SCORES
      response:
        type: journey
        journeyStepId: /journey/evaluate-gpg45-scores

DEBUG_EVALUATE_GPG45_SCORES:
  name: DEBUG_EVALUATE_GPG45_SCORES
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: DEBUG_PAGE
      response:
        type: page
        pageId: page-ipv-debug
    end:
      type: basic
      name: next
      targetState: DEBUG_PAGE
      response:
        type: page
        pageId: page-ipv-debug
    pyi-no-match:
      type: basic
      name: pyi-no-match
      targetState: DEBUG_PYI_NO_MATCH
      response:
        type: page
        pageId: pyi-no-match
    pyi-kbv-fail:
      type: basic
      name: pyi-kbv-fail
      targetState: DEBUG_PYI_KBV_FAIL
      response:
        type: page
        pageId: pyi-kbv-fail
DEBUG_PYI_NO_MATCH:
  name: DEBUG_PYI_NO_MATCH
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: DEBUG_PAGE
      response:
        type: page
        pageId: page-ipv-debug
DEBUG_PYI_KBV_FAIL:
  name: DEBUG_PYI_KBV_FAIL
  parent: ATTEMPT_RECOVERY_STATE
  events:
    next:
      type: basic
      name: next
      targetState: DEBUG_PAGE
      response:
        type: page
        pageId: page-ipv-debug
