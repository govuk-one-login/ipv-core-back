# Dynamo Helper Scripts

A set of bash and python scripts to pull data from the VC table in DynamoDB and process the results

## Requirements

- Python 3.x <https://www.python.org/downloads/>
- Configured AWS CLI <https://govukverify.atlassian.net/wiki/spaces/PLAT/pages/3364586065/IAM+Identity+Centre+-+SSO+Access+via+CLI+and+Console>

## scan.sh

Bash script to run a scan query against the `user-issued-credentials-v2-<env>` table in a given aws account `<profile>`.
Groups results by CRI type provided in the file `expression-attribute-values-<cri>.json`.
Projects attributes given in the file `expression-attribute-names.json`.
Writes results to a file in the location `<env>/<cri>-results.json`.

`<env>` refers to the targeted AWS environment e.g. build
`<cri>` refers to the targeted CRI type e.g. address
`<profile>` refers to a configured AWS CLI profile

Example usage `./scan.sh -e build -p ipv-core-build`

## find_uuids_by_date.py

Python script to query files generated by the above scan script. Produces a file with a list of UUIDs for a given query.

### Usage

`find_uuids_by_date.py -e <env> -f <resultsfile> -d <date>`
`find_uuids_by_date.py -e build -f address-results -d 2024-01-04`

`<env>` is the name of the environment folder to target
`<resultsfile>` is the name of the file to query
`<date>` is the date to query for in the format `YYYY-MM-DD` e.g `2024-01-04`
